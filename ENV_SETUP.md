# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω –≤ —Ñ–∞–π–ª .env
cp ENV_SETUP.md .env
```

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞

#### –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# ===========================================
# –°–ï–†–í–ï–†–ù–ê–Ø –ß–ê–°–¢–¨ (server.js)
# ===========================================

# –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000

# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (development/production)
NODE_ENV=development

# ===========================================
# –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø
# ===========================================

# Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
TELEGRAM_BOT_TOKEN=your_bot_token_here

# ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Telegram (–ø–æ–ª—É—á–∏—Ç—å –∫–æ–º–∞–Ω–¥–æ–π npm run get:user-id)
ADMIN_USER_ID=your_admin_user_id_here

# –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è API (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –∑–∞–¥–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
API_SECRET_KEY=your_secret_api_key_here

# –ö–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = API_SECRET_KEY)
FRONTEND_API_KEY=your_frontend_api_key_here

# –•–µ—à –ø–∞—Ä–æ–ª—è –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π npm run setup:password)
EDITOR_PASSWORD_HASH=your_password_hash_here

# ===========================================
# –í–ù–ï–®–ù–ò–ï –°–ï–†–í–ò–°–´
# ===========================================

# Cloudinary –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# ===========================================
# –§–†–û–ù–¢–ï–ù–î (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º VITE_)
# ===========================================

# URL API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–ù–ï –°–ï–ö–†–ï–¢! –ü–æ–ø–∞–¥–∞–µ—Ç –≤ –ø—É–±–ª–∏—á–Ω—ã–π bundle)
# –í development –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è http://localhost:3000/api
# –í production —É–∫–∞–∂–∏—Ç–µ –≤–∞—à API –¥–æ–º–µ–Ω
VITE_API_URL=https://your-api-domain.com/api

# –ö–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–ù–ï –°–ï–ö–†–ï–¢! –ü–æ–ø–∞–¥–∞–µ—Ç –≤ –ø—É–±–ª–∏—á–Ω—ã–π bundle)
# –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –∫–ª—é—á —á—Ç–æ –∏ API_SECRET_KEY –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π
VITE_FRONTEND_KEY=your_frontend_key_here
```

#### –û–ü–¶–ò–û–ù–ê–õ–¨–ù–´–ï –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# ===========================================
# –°–ï–¢–ï–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò
# ===========================================

# URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–¥–ª—è CORS)
FRONTEND_URL=https://nifoleyarc.github.io/rephhggvi

# Webhook URL –¥–ª—è Telegram –±–æ—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è production)
WEBHOOK_URL=https://your-api-domain.com/api/webhook

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ IP –¥–ª—è whitelist (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# IP_WHITELIST=192.168.1.1,10.0.0.1

# ===========================================
# –ë–ê–ó–ê –î–ê–ù–ù–´–•
# ===========================================

# SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ server/database/streams.db
DATABASE_PATH=server/database/streams.db

# ===========================================
# –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò
# ===========================================

# –í–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
DEBUG=true

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (–≤ MB)
MAX_FILE_SIZE=10
```

## 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥

### Development (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):

```env
NODE_ENV=development
PORT=3000
VITE_API_URL=http://localhost:3000/api
```

### Production (—Å–µ—Ä–≤–µ—Ä):

```env
NODE_ENV=production
PORT=3000
VITE_API_URL=https://your-api-domain.com/api
WEBHOOK_URL=https://your-api-domain.com/api/webhook
```

## 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è GitHub Pages

### –î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ GitHub Pages:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –í—ã–±–µ—Ä–∏—Ç–µ **Secrets and variables** ‚Üí **Actions**
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   - `VITE_API_URL` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤–∞—à–µ–≥–æ API –¥–æ–º–µ–Ω–∞
   - `VITE_FRONTEND_KEY` —Å –∫–ª—é—á–æ–º –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º

**‚ùó –í–ê–ñ–ù–û**: `VITE_API_URL` –∏ `VITE_FRONTEND_KEY` –ù–ï —è–≤–ª—è—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏! –û–Ω–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –ø—É–±–ª–∏—á–Ω—ã–π bundle —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

## 5. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
# –ü–æ–ª—É—á–∏—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
npm run get:user-id

# –°–æ–∑–¥–∞—Ç—å —Ö–µ—à –ø–∞—Ä–æ–ª—è –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
npm run setup:password

# –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Frontend –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
npm run generate:frontend-key

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
npm run check:api-config

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ GitHub
npm run check:github-vars

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –¥–ª—è Telegram –±–æ—Ç–∞
npm run setup:webhook

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å webhook
npm run check:webhook
```

## 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ß—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º:
- ‚úÖ `TELEGRAM_BOT_TOKEN`
- ‚úÖ `API_SECRET_KEY`
- ‚úÖ `EDITOR_PASSWORD_HASH`
- ‚úÖ `CLOUDINARY_API_SECRET`
- ‚úÖ `ADMIN_USER_ID`
- ‚úÖ `FRONTEND_API_KEY` (—Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–Ω–∞—è)

### –ß—Ç–æ –ù–ï —è–≤–ª—è–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º:
- ‚ùå `VITE_API_URL` (–ø–æ–ø–∞–¥–∞–µ—Ç –≤ frontend bundle)
- ‚ùå `VITE_FRONTEND_KEY` (–ø–æ–ø–∞–¥–∞–µ—Ç –≤ frontend bundle)
- ‚ùå `PORT`
- ‚ùå `FRONTEND_URL`
- ‚ùå `CLOUDINARY_CLOUD_NAME`

## 7. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –°–ø–æ—Å–æ–±—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

1. **Telegram Web App** (–æ—Å–Ω–æ–≤–Ω–æ–π):
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `initData` –æ—Ç Telegram
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ `TELEGRAM_BOT_TOKEN`
   - –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è `ADMIN_USER_ID`

2. **API –∫–ª—é—á** (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤):
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: `Authorization: Bearer YOUR_API_SECRET_KEY`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `API_SECRET_KEY`

3. **–ü–∞—Ä–æ–ª—å** (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø):
   - –ü–æ–ª–µ `password` –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ `EDITOR_PASSWORD_HASH`

4. **Frontend –∫–ª—é—á** (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º):
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: `x-frontend-key: YOUR_FRONTEND_KEY`
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Origin/Referer
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –¥–∞–Ω–Ω—ã–º

### Endpoints —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º:
- `GET /api/streams` - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∏–º–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç frontend –∫–ª—é—á –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ origin)
- `GET /api/categories` - –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Ç—Ä–µ–±—É–µ—Ç frontend –∫–ª—é—á –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ origin)
- `GET /api/` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ (—Ç—Ä–µ–±—É–µ—Ç frontend –∫–ª—é—á –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ origin)

### –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints:
- `POST/PUT/DELETE /api/streams` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∏–º–∞–º–∏
- `POST/PUT/DELETE /api/categories` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- `POST /api/refresh-thumbnails` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–≤—å—é

## 8. Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "API –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è"
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `VITE_API_URL` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `server.js`

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ API"
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `ADMIN_USER_ID` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `TELEGRAM_BOT_TOKEN` –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram

### –ü—Ä–æ–±–ª–µ–º–∞: "405 Method Not Allowed" –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: `npm run check:api-config`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `VITE_API_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ GitHub Variables
3. –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `https://gensyxavods.com/api` (–ù–ï github.io!)
4. –°–¥–µ–ª–∞–π—Ç–µ –Ω–æ–≤—ã–π deploy –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è"
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –ø—Ä–æ–±–µ–ª–æ–≤ –≤–æ–∫—Ä—É–≥ `=`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`

### –ü—Ä–æ–±–ª–µ–º–∞: "–ó–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ GitHub Pages –≤–º–µ—Å—Ç–æ API —Å–µ—Ä–≤–µ—Ä–∞"
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `API_CONFIG` –≤–º–µ—Å—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π
2. –í –∫–æ–¥–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `'/api'` –∏–ª–∏ `'/api/auth'`
3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `API_CONFIG.baseURL + '/auth'` 